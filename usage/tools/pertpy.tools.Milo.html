<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="pertpy.tools.Sccoda" href="pertpy.tools.Sccoda.html" /><link rel="prev" title="pertpy.tools.Mixscape" href="pertpy.tools.Mixscape.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.07.26 -->
        <title>pertpy.tools.Milo - pertpy</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/override.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/sphinx_gallery.css?v=4d525498" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #003262;
  --color-brand-content: #003262per;
  --admonition-font-size: var(--font-size-normal);
  --admonition-title-font-size: var(--font-size-normal);
  --code-font-size: var(--font-size--small);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">pertpy</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../usage.html">Usage</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Usage</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.adamson_2016_pilot.html">pertpy.data.adamson_2016_pilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.adamson_2016_upr_epistasis.html">pertpy.data.adamson_2016_upr_epistasis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.adamson_2016_upr_perturb_seq.html">pertpy.data.adamson_2016_upr_perturb_seq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.aissa_2021.html">pertpy.data.aissa_2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.bhattacherjee.html">pertpy.data.bhattacherjee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.burczynski_crohn.html">pertpy.data.burczynski_crohn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.chang_2021.html">pertpy.data.chang_2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.datlinger_2017.html">pertpy.data.datlinger_2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.datlinger_2021.html">pertpy.data.datlinger_2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.dialogue_example.html">pertpy.data.dialogue_example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.dixit_2016.html">pertpy.data.dixit_2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.dixit_2016_raw.html">pertpy.data.dixit_2016_raw</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.dixit_2016_scperturb.html">pertpy.data.dixit_2016_scperturb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.frangieh_2021.html">pertpy.data.frangieh_2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.frangieh_2021_protein.html">pertpy.data.frangieh_2021_protein</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.frangieh_2021_raw.html">pertpy.data.frangieh_2021_raw</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.frangieh_2021_rna.html">pertpy.data.frangieh_2021_rna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.gasperini_2019_atscale.html">pertpy.data.gasperini_2019_atscale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.gasperini_2019_highmoi.html">pertpy.data.gasperini_2019_highmoi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.gasperini_2019_lowmoi.html">pertpy.data.gasperini_2019_lowmoi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.gehring_2019.html">pertpy.data.gehring_2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.haber_2017_regions.html">pertpy.data.haber_2017_regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.kang_2018.html">pertpy.data.kang_2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.mcfarland_2020.html">pertpy.data.mcfarland_2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.norman_2019.html">pertpy.data.norman_2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.norman_2019_raw.html">pertpy.data.norman_2019_raw</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.papalexi_2021.html">pertpy.data.papalexi_2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.replogle_2022_k562_essential.html">pertpy.data.replogle_2022_k562_essential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.replogle_2022_k562_gwps.html">pertpy.data.replogle_2022_k562_gwps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.replogle_2022_rpe1.html">pertpy.data.replogle_2022_rpe1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.sc_sim_augur.html">pertpy.data.sc_sim_augur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.schiebinger_2019_16day.html">pertpy.data.schiebinger_2019_16day</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.schiebinger_2019_18day.html">pertpy.data.schiebinger_2019_18day</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.schraivogel_2020_tap_screen_chr8.html">pertpy.data.schraivogel_2020_tap_screen_chr8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.schraivogel_2020_tap_screen_chr11.html">pertpy.data.schraivogel_2020_tap_screen_chr11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.sciplex3_raw.html">pertpy.data.sciplex3_raw</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.shifrut_2018.html">pertpy.data.shifrut_2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.smillie.html">pertpy.data.smillie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.srivatsan_2020_sciplex2.html">pertpy.data.srivatsan_2020_sciplex2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.srivatsan_2020_sciplex3.html">pertpy.data.srivatsan_2020_sciplex3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.srivatsan_2020_sciplex4.html">pertpy.data.srivatsan_2020_sciplex4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.stephenson_2021_subsampled.html">pertpy.data.stephenson_2021_subsampled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.tian_2019_day7neuron.html">pertpy.data.tian_2019_day7neuron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.tian_2019_ipsc.html">pertpy.data.tian_2019_ipsc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.tian_2021_crispra.html">pertpy.data.tian_2021_crispra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.tian_2021_crispri.html">pertpy.data.tian_2021_crispri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.weinreb_2020.html">pertpy.data.weinreb_2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.xie_2017.html">pertpy.data.xie_2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pertpy.data.zhao_2021.html">pertpy.data.zhao_2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/pertpy.preprocessing.GuideAssignment.html">pertpy.preprocessing.GuideAssignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.Mixscape.html">pertpy.tools.Mixscape</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">pertpy.tools.Milo</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.Sccoda.html">pertpy.tools.Sccoda</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.Tasccoda.html">pertpy.tools.Tasccoda</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.Dialogue.html">pertpy.tools.Dialogue</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.Distance.html">pertpy.tools.Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.DistanceTest.html">pertpy.tools.DistanceTest</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.CellLineMetaData.html">pertpy.tools.CellLineMetaData</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.Augur.html">pertpy.tools.Augur</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.SCGEN.html">pertpy.tools.SCGEN</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.DiscriminatorClassifierSpace.html">pertpy.tools.DiscriminatorClassifierSpace</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.CentroidSpace.html">pertpy.tools.CentroidSpace</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.DBSCANSpace.html">pertpy.tools.DBSCANSpace</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.KMeansSpace.html">pertpy.tools.KMeansSpace</a></li>
<li class="toctree-l2"><a class="reference internal" href="pertpy.tools.PseudobulkSpace.html">pertpy.tools.PseudobulkSpace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.guide.html">pertpy.plot.guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.ms.violin.html">pertpy.plot.ms.violin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.ms.perturbscore.html">pertpy.plot.ms.perturbscore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.ms.heatmap.html">pertpy.plot.ms.heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.ms.barplot.html">pertpy.plot.ms.barplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.ms.lda.html">pertpy.plot.ms.lda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.milo.nhood_graph.html">pertpy.plot.milo.nhood_graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.milo.nhood.html">pertpy.plot.milo.nhood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.milo.da_beeswarm.html">pertpy.plot.milo.da_beeswarm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.milo.nhood_counts_by_cond.html">pertpy.plot.milo.nhood_counts_by_cond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.coda.stacked_barplot.html">pertpy.plot.coda.stacked_barplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.coda.effects_barplot.html">pertpy.plot.coda.effects_barplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.coda.boxplots.html">pertpy.plot.coda.boxplots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.coda.rel_abundance_dispersion_plot.html">pertpy.plot.coda.rel_abundance_dispersion_plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.coda.draw_tree.html">pertpy.plot.coda.draw_tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.coda.draw_effects.html">pertpy.plot.coda.draw_effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.coda.effects_umap.html">pertpy.plot.coda.effects_umap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.ag.dp_scatter.html">pertpy.plot.ag.dp_scatter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.ag.important_features.html">pertpy.plot.ag.important_features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.ag.lollipop.html">pertpy.plot.ag.lollipop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.ag.scatterplot.html">pertpy.plot.ag.scatterplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.scg.reg_mean_plot.html">pertpy.plot.scg.reg_mean_plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.scg.reg_var_plot.html">pertpy.plot.scg.reg_var_plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/pertpy.plot.scg.binary_classifier.html">pertpy.plot.scg.binary_classifier</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_of_conduct.html">Contributor Covenant Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/theislab/pertpy/discussions">Discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="pertpy-tools-milo">
<h1>pertpy.tools.Milo<a class="headerlink" href="#pertpy-tools-milo" title="Permalink to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pertpy.tools.Milo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pertpy.tools.</span></span><span class="sig-name descname"><span class="pre">Milo</span></span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo" title="Permalink to this definition">#</a></dt>
<dd><p>Python implementation of Milo.</p>
</dd></dl>

<section id="methods-table">
<h2>Methods table<a class="headerlink" href="#methods-table" title="Permalink to this heading">#</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pertpy.tools.Milo.add_covariate_to_nhoods_var" title="pertpy.tools.Milo.add_covariate_to_nhoods_var"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_covariate_to_nhoods_var</span></code></a>(mdata, ...[, ...])</p></td>
<td><p>Add covariate from cell-level obs to sample-level obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pertpy.tools.Milo.add_nhood_expression" title="pertpy.tools.Milo.add_nhood_expression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_nhood_expression</span></code></a>(mdata[, layer, feature_key])</p></td>
<td><p>Calculates the mean expression in neighbourhoods of each feature.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pertpy.tools.Milo.annotate_nhoods" title="pertpy.tools.Milo.annotate_nhoods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">annotate_nhoods</span></code></a>(mdata, anno_col[, feature_key])</p></td>
<td><p>Assigns a categorical label to neighbourhoods, based on the most frequent label among cells in each neighbourhood.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pertpy.tools.Milo.annotate_nhoods_continuous" title="pertpy.tools.Milo.annotate_nhoods_continuous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">annotate_nhoods_continuous</span></code></a>(mdata, anno_col)</p></td>
<td><p>Assigns a continuous value to neighbourhoods, based on mean cell level covariate stored in adata.obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pertpy.tools.Milo.build_nhood_graph" title="pertpy.tools.Milo.build_nhood_graph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_nhood_graph</span></code></a>(mdata[, basis, feature_key])</p></td>
<td><p>Build graph of neighbourhoods used for visualization of DA results</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pertpy.tools.Milo.count_nhoods" title="pertpy.tools.Milo.count_nhoods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_nhoods</span></code></a>(data, sample_col[, feature_key])</p></td>
<td><p>Builds a sample-level AnnData object storing the matrix of cell counts per sample per neighbourhood.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pertpy.tools.Milo.da_nhoods" title="pertpy.tools.Milo.da_nhoods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">da_nhoods</span></code></a>(mdata, design[, model_contrasts, ...])</p></td>
<td><p>Performs differential abundance testing on neighbourhoods using QLF test implementation as implemented in edgeR.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pertpy.tools.Milo.load" title="pertpy.tools.Milo.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(input[, feature_key])</p></td>
<td><p>Prepare a MuData object for subsequent processing.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pertpy.tools.Milo.make_nhoods" title="pertpy.tools.Milo.make_nhoods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_nhoods</span></code></a>(data[, neighbors_key, ...])</p></td>
<td><p>Randomly sample vertices on a KNN graph to define neighbourhoods of cells.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">#</a></h2>
<section id="add-covariate-to-nhoods-var">
<h3>add_covariate_to_nhoods_var<a class="headerlink" href="#add-covariate-to-nhoods-var" title="Permalink to this heading">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="pertpy.tools.Milo.add_covariate_to_nhoods_var">
<span class="sig-prename descclassname"><span class="pre">Milo.</span></span><span class="sig-name descname"><span class="pre">add_covariate_to_nhoods_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_covariates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo.add_covariate_to_nhoods_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo.add_covariate_to_nhoods_var" title="Permalink to this definition">#</a></dt>
<dd><p>Add covariate from cell-level obs to sample-level obs. These should be covariates for which a single value can be assigned to each sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdata</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">MuData</span></code>) – MuData object</p></li>
<li><p><strong>new_covariates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – columns in <cite>milo_mdata[feature_key].obs</cite> to add to <cite>milo_mdata[‘milo’].obs</cite>.</p></li>
<li><p><strong>feature_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – If input data is MuData, specify key to cell-level AnnData object. Defaults to ‘rna’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None, adds columns to <cite>milo_mdata[‘milo’]</cite> in place</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="add-nhood-expression">
<h3>add_nhood_expression<a class="headerlink" href="#add-nhood-expression" title="Permalink to this heading">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="pertpy.tools.Milo.add_nhood_expression">
<span class="sig-prename descclassname"><span class="pre">Milo.</span></span><span class="sig-name descname"><span class="pre">add_nhood_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo.add_nhood_expression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo.add_nhood_expression" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the mean expression in neighbourhoods of each feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdata</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">MuData</span></code>) – MuData object</p></li>
<li><p><strong>layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – If provided, use <cite>milo_mdata[feature_key][layer]</cite> as expression matrix instead of <cite>milo_mdata[feature_key].X</cite>. Defaults to None.</p></li>
<li><p><strong>feature_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – If input data is MuData, specify key to cell-level AnnData object. Defaults to ‘rna’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updates adata in place to store the matrix of average expression in each neighbourhood in <cite>milo_mdata[‘milo’].varm[‘expr’]</cite></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="annotate-nhoods">
<h3>annotate_nhoods<a class="headerlink" href="#annotate-nhoods" title="Permalink to this heading">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="pertpy.tools.Milo.annotate_nhoods">
<span class="sig-prename descclassname"><span class="pre">Milo.</span></span><span class="sig-name descname"><span class="pre">annotate_nhoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anno_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo.annotate_nhoods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo.annotate_nhoods" title="Permalink to this definition">#</a></dt>
<dd><p>Assigns a categorical label to neighbourhoods, based on the most frequent label among cells in each neighbourhood. This can be useful to stratify DA testing results by cell types or samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdata</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">MuData</span></code>) – MuData object</p></li>
<li><p><strong>anno_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Column in adata.obs containing the cell annotations to use for nhood labelling</p></li>
<li><p><strong>feature_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – If input data is MuData, specify key to cell-level AnnData object. Defaults to ‘rna’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>milo_mdata[‘milo’].var[“nhood_annotation”]</cite>: assigning a label to each nhood</p></li>
<li><p><cite>milo_mdata[‘milo’].var[“nhood_annotation_frac”]</cite> stores the fraciton of cells in the neighbourhood with the assigned label</p></li>
<li><p><cite>milo_mdata[‘milo’].varm[‘frac_annotation’]</cite>: stores the fraction of cells from each label in each nhood</p></li>
<li><p><cite>milo_mdata[‘milo’].uns[“annotation_labels”]</cite>: stores the column names for <cite>milo_mdata[‘milo’].varm[‘frac_annotation’]</cite></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None. Adds in place</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="annotate-nhoods-continuous">
<h3>annotate_nhoods_continuous<a class="headerlink" href="#annotate-nhoods-continuous" title="Permalink to this heading">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="pertpy.tools.Milo.annotate_nhoods_continuous">
<span class="sig-prename descclassname"><span class="pre">Milo.</span></span><span class="sig-name descname"><span class="pre">annotate_nhoods_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anno_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo.annotate_nhoods_continuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo.annotate_nhoods_continuous" title="Permalink to this definition">#</a></dt>
<dd><p>Assigns a continuous value to neighbourhoods, based on mean cell level covariate stored in adata.obs. This can be useful to correlate DA log-foldChanges with continuous covariates such as pseudotime, gene expression scores etc…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdata</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">MuData</span></code>) – MuData object</p></li>
<li><p><strong>anno_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Column in adata.obs containing the cell annotations to use for nhood labelling</p></li>
<li><p><strong>feature_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – If input data is MuData, specify key to cell-level AnnData object. Defaults to ‘rna’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>milo_mdata[‘milo’].var[“nhood_{anno_col}”]</cite>: assigning a continuous value to each nhood</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None. Adds in place</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="build-nhood-graph">
<h3>build_nhood_graph<a class="headerlink" href="#build-nhood-graph" title="Permalink to this heading">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="pertpy.tools.Milo.build_nhood_graph">
<span class="sig-prename descclassname"><span class="pre">Milo.</span></span><span class="sig-name descname"><span class="pre">build_nhood_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X_umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo.build_nhood_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo.build_nhood_graph" title="Permalink to this definition">#</a></dt>
<dd><p>Build graph of neighbourhoods used for visualization of DA results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdata</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">MuData</span></code>) – MuData object</p></li>
<li><p><strong>basis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the obsm basis to use for layout of neighbourhoods (key in <cite>adata.obsm</cite>). Defaults to “X_umap”.</p></li>
<li><p><strong>feature_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – If input data is MuData, specify key to cell-level AnnData object. Defaults to ‘rna’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>graph of overlap between neighbourhoods (i.e. no of shared cells)
- <cite>milo_mdata[‘milo’].var[“Nhood_size”]</cite>: number of cells in neighbourhoods</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><cite>milo_mdata[‘milo’].varp[‘nhood_connectivities’]</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="count-nhoods">
<h3>count_nhoods<a class="headerlink" href="#count-nhoods" title="Permalink to this heading">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="pertpy.tools.Milo.count_nhoods">
<span class="sig-prename descclassname"><span class="pre">Milo.</span></span><span class="sig-name descname"><span class="pre">count_nhoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo.count_nhoods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo.count_nhoods" title="Permalink to this definition">#</a></dt>
<dd><p>Builds a sample-level AnnData object storing the matrix of cell counts per sample per neighbourhood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://anndata.readthedocs.io/en/stable/generated/anndata.AnnData.html#anndata.AnnData" title="(in anndata v0.9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnnData</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">MuData</span></code>) – AnnData object with neighbourhoods defined in <cite>obsm[‘nhoods’]</cite> or MuData object with a modality with neighbourhoods defined in <cite>obsm[‘nhoods’]</cite></p></li>
<li><p><strong>sample_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Column in adata.obs that contains sample information</p></li>
<li><p><strong>feature_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – If input data is MuData, specify key to cell-level AnnData object. (default: ‘rna’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MuData object storing the original (i.e. rna) AnnData in <cite>mudata[feature_key]</cite>
and the compositional anndata storing the neighbourhood cell counts in <cite>mudata[‘milo’]</cite>.
Here:
- <cite>mudata[‘milo’].obs_names</cite> are samples (defined from <cite>adata.obs[‘sample_col’]</cite>)
- <cite>mudata[‘milo’].var_names</cite> are neighbourhoods
- <cite>mudata[‘milo’].X</cite> is the matrix counting the number of cells from each
sample in each neighbourhood</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="da-nhoods">
<h3>da_nhoods<a class="headerlink" href="#da-nhoods" title="Permalink to this heading">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="pertpy.tools.Milo.da_nhoods">
<span class="sig-prename descclassname"><span class="pre">Milo.</span></span><span class="sig-name descname"><span class="pre">da_nhoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">design</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_contrasts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edger'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo.da_nhoods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo.da_nhoods" title="Permalink to this definition">#</a></dt>
<dd><p>Performs differential abundance testing on neighbourhoods using QLF test implementation as implemented in edgeR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdata</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">MuData</span></code>) – MuData object</p></li>
<li><p><strong>design</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Formula for the test, following glm syntax from R (e.g. ‘~ condition’).
Terms should be columns in <cite>milo_mdata[feature_key].obs</cite>.</p></li>
<li><p><strong>model_contrasts</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – A string vector that defines the contrasts used to perform DA testing, following glm syntax from R (e.g. “conditionDisease - conditionControl”).
If no contrast is specified (default), then the last categorical level in condition of interest is used as the test group. Defaults to None.</p></li>
<li><p><strong>subset_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – subset of samples (obs in <cite>milo_mdata[‘milo’]</cite>) to use for the test. Defaults to None.</p></li>
<li><p><strong>add_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – whether to include an intercept in the model. If False, this is equivalent to adding + 0 in the design formula. When model_contrasts is specified, this is set to False by default. Defaults to True.</p></li>
<li><p><strong>feature_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – If input data is MuData, specify key to cell-level AnnData object. Defaults to ‘rna’.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'edger'</span></code>, <code class="docutils literal notranslate"><span class="pre">'batchglm'</span></code>]) – The solver to fit the model to. One of “edger” (requires R, rpy2 and edgeR to be installed) or “batchglm”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><cite>logFC</cite> stores the log fold change in cell abundance (coefficient from the GLM)</p></li>
<li><p><cite>PValue</cite> stores the p-value for the QLF test before multiple testing correction</p></li>
<li><dl class="simple">
<dt><cite>SpatialFDR</cite> stores the the p-value adjusted for multiple testing to limit the false discovery rate,</dt><dd><p>calculated with weighted Benjamini-Hochberg procedure</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None, modifies <cite>milo_mdata[‘milo’]</cite> in place, adding the results of the DA test to <cite>.var</cite></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="load">
<h3>load<a class="headerlink" href="#load" title="Permalink to this heading">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="pertpy.tools.Milo.load">
<span class="sig-prename descclassname"><span class="pre">Milo.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo.load" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare a MuData object for subsequent processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference external" href="https://anndata.readthedocs.io/en/stable/generated/anndata.AnnData.html#anndata.AnnData" title="(in anndata v0.9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnnData</span></code></a>) – AnnData</p></li>
<li><p><strong>feature_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – Key to store the cell-level AnnData object in the MuData object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MuData object with original AnnData (default is <cite>mudata[feature_key]</cite>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MuData</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="make-nhoods">
<h3>make_nhoods<a class="headerlink" href="#make-nhoods" title="Permalink to this heading">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="pertpy.tools.Milo.make_nhoods">
<span class="sig-prename descclassname"><span class="pre">Milo.</span></span><span class="sig-name descname"><span class="pre">make_nhoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pertpy/tools/_milo.html#Milo.make_nhoods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pertpy.tools.Milo.make_nhoods" title="Permalink to this definition">#</a></dt>
<dd><p>Randomly sample vertices on a KNN graph to define neighbourhoods of cells.</p>
<p>The set of neighborhoods get refined by computing the median profile for the neighbourhood in reduced dimensional space
and by selecting the nearest vertex to this position.
Thus, multiple neighbourhoods may be collapsed to prevent over-sampling the graph space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://anndata.readthedocs.io/en/stable/generated/anndata.AnnData.html#anndata.AnnData" title="(in anndata v0.9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnnData</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">MuData</span></code>) – AnnData object with KNN graph defined in <cite>obsp</cite> or MuData object with a modality with KNN graph defined in <cite>obsp</cite></p></li>
<li><p><strong>neighbors_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – The key in <cite>adata.obsp</cite> or <cite>mdata[feature_key].obsp</cite> to use as KNN graph.
If not specified, <cite>make_nhoods</cite> looks .obsp[‘connectivities’] for connectivities (default storage places for <cite>scanpy.pp.neighbors</cite>).
If specified, it looks at .obsp[.uns[neighbors_key][‘connectivities_key’]] for connectivities.
(default: None)</p></li>
<li><p><strong>feature_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – If input data is MuData, specify key to cell-level AnnData object. (default: ‘rna’)</p></li>
<li><p><strong>prop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Fraction of cells to sample for neighbourhood index search. (default: 0.1)</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Random seed for cell sampling. (default: 0)</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Determines whether a copy of the <cite>adata</cite> is returned. (default: False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>If <cite>copy=True</cite>, returns the copy of <cite>adata</cite> with the result in <cite>.obs</cite>, <cite>.obsm</cite>, and <cite>.uns</cite>.
Otherwise:</p>
<p>nhoods: scipy.sparse._csr.csr_matrix in <cite>adata.obsm[‘nhoods’]</cite>.
A binary matrix of cell to neighbourhood assignments. Neighbourhoods in the columns are ordered by the order of the index cell in adata.obs_names</p>
<p>nhood_ixs_refined: pandas.Series in <cite>adata.obs[‘nhood_ixs_refined’]</cite>.
A boolean indicating whether a cell is an index for a neighbourhood</p>
<p>nhood_kth_distance: pandas.Series in <cite>adata.obs[‘nhood_kth_distance’]</cite>.
The distance to the kth nearest neighbour for each index cell (used for SpatialFDR correction)</p>
<p>nhood_neighbors_key: <cite>adata.uns[“nhood_neighbors_key”]</cite>
KNN graph key, used for neighbourhood construction</p>
</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pertpy.tools.Sccoda.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">pertpy.tools.Sccoda</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="pertpy.tools.Mixscape.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">pertpy.tools.Mixscape</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, Lukas Heumos, Theislab
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">pertpy.tools.Milo</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo"><code class="docutils literal notranslate"><span class="pre">Milo</span></code></a></li>
<li><a class="reference internal" href="#methods-table">Methods table</a></li>
<li><a class="reference internal" href="#methods">Methods</a><ul>
<li><a class="reference internal" href="#add-covariate-to-nhoods-var">add_covariate_to_nhoods_var</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo.add_covariate_to_nhoods_var"><code class="docutils literal notranslate"><span class="pre">Milo.add_covariate_to_nhoods_var()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#add-nhood-expression">add_nhood_expression</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo.add_nhood_expression"><code class="docutils literal notranslate"><span class="pre">Milo.add_nhood_expression()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#annotate-nhoods">annotate_nhoods</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo.annotate_nhoods"><code class="docutils literal notranslate"><span class="pre">Milo.annotate_nhoods()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#annotate-nhoods-continuous">annotate_nhoods_continuous</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo.annotate_nhoods_continuous"><code class="docutils literal notranslate"><span class="pre">Milo.annotate_nhoods_continuous()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#build-nhood-graph">build_nhood_graph</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo.build_nhood_graph"><code class="docutils literal notranslate"><span class="pre">Milo.build_nhood_graph()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#count-nhoods">count_nhoods</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo.count_nhoods"><code class="docutils literal notranslate"><span class="pre">Milo.count_nhoods()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#da-nhoods">da_nhoods</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo.da_nhoods"><code class="docutils literal notranslate"><span class="pre">Milo.da_nhoods()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#load">load</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo.load"><code class="docutils literal notranslate"><span class="pre">Milo.load()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#make-nhoods">make_nhoods</a><ul>
<li><a class="reference internal" href="#pertpy.tools.Milo.make_nhoods"><code class="docutils literal notranslate"><span class="pre">Milo.make_nhoods()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=add265a1"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>